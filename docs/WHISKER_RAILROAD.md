# Whisker Script Railroad Diagrams

**Version:** 1.0

This document provides visual grammar references for Whisker Script. Railroad diagrams (also called syntax diagrams) show valid paths through grammar rules.

## Generating Diagrams

To generate SVG/PNG railroad diagrams from the EBNF grammar:

1. Visit https://www.bottlecaps.de/rr/ui
2. Paste contents of `WHISKER_GRAMMAR.ebnf`
3. Click "View Diagram"
4. Export as SVG or PNG

Alternatively, use command-line tools:
- `rr` (Railroad Diagram Generator)
- `railroad-diagrams` Python package
- GrammKit

## Diagram Notation

```
─────────────────  Flow (follow the line)
       │
       ▼           Branch point
      ╱ ╲
     ╱   ╲         Choice (take one path)

   ┌──────┐
   │ term │        Terminal (literal text/token)
   └──────┘

   ┌──────┐
───┤      ├───     Required element
   └──────┘

   ┌──────┐
──┬┤      ├┬──     Optional element (can skip)
  │└──────┘│
  └────────┘

  ┌───────────┐
──┤           ├┬──  Repetition (zero or more)
  └─────┬─────┘│
        └──────┘
```

## Program Structure

```
program
════════════════════════════════════════════════════

     ┌──────────────────────────────────┐
─────┤            passage               ├──┬───▶
     └──────────────────────────────────┘  │
        ▲                                  │
        └──────────────────────────────────┘
```

A program is one or more passages.

## Passage

```
passage
════════════════════════════════════════════════════

     ┌────────────────┐    ┌────────────────┐
─────┤ passage_header ├────┤    content     ├───▶
     └────────────────┘    └────────────────┘
```

A passage has a header followed by content.

## Passage Header

```
passage_header
════════════════════════════════════════════════════

     ┌────┐    ┌────────────┐    ┌─────────┐
─────┤ :: ├────┤ identifier ├────┤ newline ├───▶
     └────┘    └────────────┘    └─────────┘
```

## Content

```
content
════════════════════════════════════════════════════

     ┌─────────────────────────────────────┐
─────┤         content_element             ├──┬───▶
     └─────────────────────────────────────┘  │
        ▲                                     │
        └─────────────────────────────────────┘
```

Content is zero or more content elements.

## Content Element

```
content_element
════════════════════════════════════════════════════

         ┌────────────┐
     ┌───┤    text    ├───┐
     │   └────────────┘   │
     │   ┌────────────┐   │
     ├───┤   choice   ├───┤
     │   └────────────┘   │
     │   ┌────────────┐   │
─────┼───┤conditional ├───┼───▶
     │   └────────────┘   │
     │   ┌────────────┐   │
     ├───┤ assignment ├───┤
     │   └────────────┘   │
     │   ┌────────────┐   │
     └───┤embedded_lua├───┘
         └────────────┘
```

## Choice

```
choice
════════════════════════════════════════════════════

     ┌───┐   ┌───────────┐   ┌─────────────┐   ┌────┐   ┌────────┐   ┌─────────┐
─────┤ + ├─┬─┤ condition ├─┬─┤ choice_text ├───┤ -> ├───┤ target ├───┤ newline ├───▶
     └───┘ │ └───────────┘ │ └─────────────┘   └────┘   └────────┘   └─────────┘
           │               │
           └───────────────┘  (condition is optional)
```

## Choice Text

```
choice_text
════════════════════════════════════════════════════

     ┌───┐   ┌──────┐   ┌───┐
─────┤ [ ├───┤ text ├───┤ ] ├───▶
     └───┘   └──────┘   └───┘
```

## Conditional Block

```
conditional
════════════════════════════════════════════════════

     ┌───┐   ┌────────────┐   ┌───┐   ┌─────────┐   ┌───┐   ┌───┐   ┌───┐
─────┤ { ├───┤ expression ├───┤ } ├───┤ content ├───┤ { ├───┤ / ├───┤ } ├───▶
     └───┘   └────────────┘   └───┘   └─────────┘   └───┘   └───┘   └───┘
```

## Assignment

```
assignment
════════════════════════════════════════════════════

     ┌──────────┐   ┌─────────────────┐   ┌───────┐   ┌─────────┐
─────┤ variable ├───┤ assign_operator ├───┤ value ├───┤ newline ├───▶
     └──────────┘   └─────────────────┘   └───────┘   └─────────┘
```

## Variable

```
variable
════════════════════════════════════════════════════

     ┌───┐   ┌────────────┐
─────┤ $ ├───┤ identifier ├───▶
     └───┘   └────────────┘
```

## Expression

```
expression
════════════════════════════════════════════════════

     ┌───────────────┐
─────┤ or_expression ├───▶
     └───────────────┘
```

## OR Expression

```
or_expression
════════════════════════════════════════════════════

     ┌────────────────┐        ┌────┐   ┌────────────────┐
─────┤ and_expression ├──┬─────┤ || ├───┤ and_expression ├──┬───▶
     └────────────────┘  │     └────┘   └────────────────┘  │
                         │ ▲                                │
                         │ └────────────────────────────────┘
                         │
                         └───────────────────────────────────────▶
```

## AND Expression

```
and_expression
════════════════════════════════════════════════════

     ┌───────────────────────┐        ┌────┐   ┌───────────────────────┐
─────┤ comparison_expression ├──┬─────┤ && ├───┤ comparison_expression ├──┬───▶
     └───────────────────────┘  │     └────┘   └───────────────────────┘  │
                                │ ▲                                       │
                                │ └───────────────────────────────────────┘
                                │
                                └──────────────────────────────────────────────▶
```

## Comparison Expression

```
comparison_expression
════════════════════════════════════════════════════

     ┌──────────────────┐        ┌─────────────────────┐   ┌──────────────────┐
─────┤ unary_expression ├──┬─────┤ comparison_operator ├───┤ unary_expression ├──┬───▶
     └──────────────────┘  │     └─────────────────────┘   └──────────────────┘  │
                           │                                                     │
                           └─────────────────────────────────────────────────────┘
```

## Comparison Operator

```
comparison_operator
════════════════════════════════════════════════════

         ┌────┐
     ┌───┤ == ├───┐
     │   └────┘   │
     │   ┌────┐   │
     ├───┤ != ├───┤
     │   └────┘   │
     │   ┌────┐   │
─────┼───┤ <  ├───┼───▶
     │   └────┘   │
     │   ┌────┐   │
     ├───┤ >  ├───┤
     │   └────┘   │
     │   ┌────┐   │
     ├───┤ <= ├───┤
     │   └────┘   │
     │   ┌────┐   │
     └───┤ >= ├───┘
         └────┘
```

## Unary Expression

```
unary_expression
════════════════════════════════════════════════════

         ┌───┐
     ┌───┤ ! ├───┐   ┌────────────────────┐
─────┤   └───┘   ├───┤ primary_expression ├───▶
     │           │   └────────────────────┘
     └───────────┘
```

## Primary Expression

```
primary_expression
════════════════════════════════════════════════════

         ┌──────────┐
     ┌───┤ variable ├───┐
     │   └──────────┘   │
     │   ┌──────────┐   │
─────┼───┤ literal  ├───┼───▶
     │   └──────────┘   │
     │                  │
     │   ┌───┐ ┌────────────┐ ┌───┐
     └───┤ ( ├─┤ expression ├─┤ ) ├───┘
         └───┘ └────────────┘ └───┘
```

## Literal

```
literal
════════════════════════════════════════════════════

         ┌────────┐
     ┌───┤ number ├───┐
     │   └────────┘   │
     │   ┌────────┐   │
─────┼───┤ string ├───┼───▶
     │   └────────┘   │
     │   ┌─────────┐  │
     └───┤ boolean ├──┘
         └─────────┘
```

## Assign Operator

```
assign_operator
════════════════════════════════════════════════════

         ┌───┐
     ┌───┤ = ├───┐
     │   └───┘   │
     │   ┌────┐  │
─────┼───┤ += ├──┼───▶
     │   └────┘  │
     │   ┌────┐  │
     └───┤ -= ├──┘
         └────┘
```

## Embedded Lua

```
embedded_lua
════════════════════════════════════════════════════

     ┌────┐   ┌──────────┐   ┌────┐
─────┤ {{ ├───┤ lua_code ├───┤ }} ├───▶
     └────┘   └──────────┘   └────┘
```

## Comments

```
line_comment
════════════════════════════════════════════════════

     ┌────┐   ┌─────────────────────────────────┐   ┌─────────┐
─────┤ // ├───┤ any characters except newline   ├───┤ newline ├───▶
     └────┘   └─────────────────────────────────┘   └─────────┘


block_comment
════════════════════════════════════════════════════

     ┌────┐   ┌─────────────────────────┐   ┌────┐
─────┤ /* ├───┤ any characters          ├───┤ */ ├───▶
     └────┘   └─────────────────────────┘   └────┘
```

---

*These diagrams provide a visual reference for the Whisker Script grammar.*
*For interactive diagrams, use the EBNF grammar with a railroad diagram generator.*
